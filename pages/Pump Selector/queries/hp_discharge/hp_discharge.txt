SELECT
  m.model_code,
  m.hp,
  pp.discharge_lpm,
  pp.head_m
FROM models m
JOIN performance_points pp ON pp.model_id = m.id
WHERE m.is_active = 1
  AND ABS(m.hp - {{ Input_HP.text || 0 }}) < 1e-9

  -- âœ… Option B: omit the 1st (minimum) discharge point for each model
  AND pp.discharge_lpm >
      (SELECT MIN(pp2.discharge_lpm)
       FROM performance_points pp2
       WHERE pp2.model_id = m.id)

ORDER BY
  (pp.discharge_lpm < {{ Input_Discharge.text || 0 }}),
  pp.discharge_lpm ASC,
  ABS(pp.discharge_lpm - {{ Input_Discharge.text || 0 }}) ASC
LIMIT 1;
