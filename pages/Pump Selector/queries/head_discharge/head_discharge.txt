SELECT
  m.model_code,
  m.hp,
  pp.discharge_lpm,
  pp.head_m
FROM models m
JOIN performance_points pp ON pp.model_id = m.id
WHERE m.is_active = 1
  AND pp.discharge_lpm >= {{ Input_Discharge.text || 0 }}
  AND pp.head_m        >= {{ Input_Head.text || 0 }}
ORDER BY
  m.hp ASC,                                    -- prefer lower HP first
  pp.discharge_lpm ASC,                         -- closest discharge above target
  pp.head_m ASC                                 -- closest head above target
LIMIT 1;
